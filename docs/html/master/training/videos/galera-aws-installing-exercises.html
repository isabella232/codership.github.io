<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta content="Training Video Exercises |---| Installing a Galera Cluster on AWS" name="title" />
<meta content="en-US" name="language" />
<meta content="Codership Oy, 2014 - 2019. All Rights Reserved." name="copyright" />

    <title>Training Video Exercises &#8212; Galera Cluster Documentation</title>
    
    <link rel="stylesheet" href="../../_static/reset-style.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Standard Replication &amp; Galera Cluster" href="galera-standard-replication.html" />
    <link rel="prev" title="Installing a Galera Cluster on AWS" href="galera-aws-installing.html" />


<script type="text/javascript" src="https://www.google.com/jsapi"></script>

<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<link rel="stylesheet" href="/library/_static/basic-style.css">
<link rel="stylesheet" href="/library/_static/header.css">
<link rel="stylesheet" href="/library/_static/footer.css">
<link rel="stylesheet" href="/library/_static/codership.css">
<link rel="stylesheet" media="screen and (max-width: 500px)" href="/library/_static/mobile.css"/>
<link rel="stylesheet" media="screen and (min-width:501px) and (max-width:1024px)" href="/library/_static/tablet.css"/>


<link rel="alternate" type="application/rss+xml" title="Galera Cluster for MySQL &raquo; Feed" href="https://galeracluster.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Galera Cluster for MySQL &raquo; Comments Feed" href="https://galeracluster.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Galera Cluster for MySQL &raquo; Support Comments Feed" href="https://galeracluster.com/support/feed/" />

<script type='text/javascript' src='https://galeracluster.com/wp-includes/js/comment-reply.min.js?ver=3.8.3'></script>

<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://galeracluster.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://galeracluster.com/wp-includes/wlwmanifest.xml" />
<link rel='prev' title='Downloads' href='https://galeracluster.com/downloads/' />
<link rel='next' title='Community' href='https://galeracluster.com/community/' />
<meta name="generator" content="WordPress 3.8.3" />

<link rel='shortlink' href='https://galeracluster.com/?p=12' />

<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<style type="text/css" id="twentythirteen-header-css">
			.site-title,
			.site-description {
				position: absolute;
				clip: rect(1px 1px 1px 1px); /* IE7 */
				clip: rect(1px, 1px, 1px, 1px);
			}
				.site-header .home-link {
				min-height: 0;
			}
</style>

<script type="text/javascript">

		  var _gaq = _gaq || [];
		  _gaq.push(['_setAccount', 'UA-35163478-6']);
		  _gaq.push(['_trackPageview']);

		  (function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'https://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		  })();

</script>

  </head>
  <body role="document">
	<div id="fb-root"></div>
	<script>(function(d, s, id) {
		  var js, fjs = d.getElementsByTagName(s)[0];
		  if (d.getElementById(id)) return;
		  js = d.createElement(s); js.id = id;
		  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
		  fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));
	</script>

	<div id="page" class="hfeed site">

	<header id="masthead" class="site-header" role="banner">

	<div class="top">
	<a class="home-link" href="https://galeracluster.com/" title="Galera Cluster for MySQL" rel="home">
	<h1 class="site-title">Galera Cluster for MySQL</h1>
	<h2 class="site-description">The world&#039;s most advanced open source database cluster</h2>
	</a>
	</div>


	<div id="navbar" class="navbar">
	<nav id="site-navigation" class="navigation main-navigation" role="navigation">
	<div class="menu-main-menu-container">

	<ul id="menu-main-menu" class="nav-menu">
	<li id="menu-item-359" class="link-home menu-item menu-item-type-post_type menu-item-object-page menu-item-359"><a href="https://galeracluster.com/">Home</a></li>
	<li id="menu-item-35" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-35"><a href="https://galeracluster.com/products/">Products</a></li>
	<li id="menu-item-34" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-34"><a href="https://galeracluster.com/downloads/">Downloads</a></li>
	<li id="menu-item-33" class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-12 current_page_item current-menu-ancestor current-menu-parent current_page_parent current_page_ancestor menu-item-has-children menu-item-33"><a href="https://galeracluster.com/support/">Support</a></li>
	<li id="menu-item-32" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-32"><a href="https://galeracluster.com/community/">Community</a></li>
	<li id="menu-item-31" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31"><a href="https://galeracluster.com/company/">Company</a></li>
	<li id="menu-item-297" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-297"><a href="https://galeracluster.com/category/blog/">Blog</a></li>
	<li id="menu-item-38" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38"><a href="https://galeracluster.com/contact-us/">Contact us</a></li>
	</ul>
	</div>


	</nav><!-- #site-navigation -->

	</div><!-- #navbar -->
	</header><!-- #masthead -->


  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="left-margin container">
<div class="left-margin-top container">
<a class="reference internal" href="../../index.html"><span class="doc">The Library</span></a></div>
<div class="left-margin-content container">
<ul>
<li><p class="first"><a class="reference internal" href="../../documentation/index.html"><span class="doc">Documentation</span></a></p>
</li>
<li><p class="first"><a class="reference internal" href="../../kb/index.html"><span class="doc">Knowledge Base</span></a></p>
</li>
<li><p class="first"><a class="reference internal" href="../index.html"><span class="doc">Training</span></a></p>
<ul class="sub-links simple">
<li><a class="reference internal" href="../tutorials/index.html"><span class="doc">Tutorial Articles</span></a></li>
</ul>
<ul class="sub-links here simple">
<li><a class="reference internal" href="index.html"><span class="doc">Training Videos</span></a></li>
</ul>
</li>
<li><p class="first"><a class="reference internal" href="../../faq.html"><span class="doc">FAQ</span></a></p>
</li>
</ul>
<p>Related Documents</p>
<ul class="simple">
<li><a class="reference internal" href="../../documentation/firewall-settings.html"><span class="doc">Firewall Settings</span></a></li>
<li><a class="reference internal" href="../../documentation/firewalld.html"><span class="doc">firewalld</span></a></li>
<li><a class="reference internal" href="../../documentation/install.html"><span class="doc">Installing Galera</span></a></li>
<li><a class="reference internal" href="../../documentation/node-provisioning.html"><span class="doc">Node Provisioning</span></a></li>
<li><a class="reference internal" href="../../documentation/selinux.html"><span class="doc">SELinux</span></a></li>
<li><a class="reference internal" href="../../documentation/state-transfer.html"><span class="doc">State Transfer</span></a></li>
<li><a class="reference internal" href="../../documentation/mysql-wsrep-options.html"><span class="doc">wsrep Options</span></a></li>
</ul>
<p>Other Resources</p>
<ul class="simple">
<li><a class="reference external" href="https://downloads.mariadb.org/mariadb/repositories/">MariaDB Repo. Generator</a></li>
<li><a class="reference external" href="http://releases.galeracluster.com/">Galera Repository</a></li>
<li><a class="reference external" href="../../documentation/install-mysql.html#mysql-yum-repo">Configure Repo File</a></li>
</ul>
</div>
</div>
<div class="top-links container">
<ul class="simple">
<li><a class="reference external" href="https://galeracluster.com">Home</a></li>
<li><a class="reference internal" href="../../documentation/index.html"><span class="doc">Docs</span></a></li>
<li><a class="reference internal" href="../../kb/index.html"><span class="doc">KB</span></a></li>
</ul>
<ul class="here nav-wider simple">
<li><a class="reference internal" href="../index.html"><span class="doc">Training</span></a></li>
</ul>
<ul class="simple">
<li><a class="reference internal" href="../../faq.html"><span class="doc">FAQ</span></a></li>
</ul>
</div>
<div class="library-article training-exercises section" id="training-video-exercises">
<span id="exercises-galera-aws-installing"></span><h1>Training Video Exercises<a class="headerlink" href="#training-video-exercises" title="Permalink to this headline">¶</a></h1>
<div class="section" id="installing-a-galera-cluster-on-aws">
<h2>Installing a Galera Cluster on AWS<a class="headerlink" href="#installing-a-galera-cluster-on-aws" title="Permalink to this headline">¶</a></h2>
<div class="video-abstract list-col2-3 container">
<p>These exercises are part of the training video, <em>Installing a Galera Cluster on AWS</em>.  They correspond to what is presented, and should be done after each section is viewed, unless otherwise noted.</p>
<p>Before starting these exercises, make sure you have all of the requirements and preparations in place.</p>
</div>
<div class="list-col1-3 container">
<p class="training-video-resources rubric">Requirements &amp; Preparation</p>
<ul class="training-video-resources simple">
<li>AWS account with access to the EC2 console.</li>
</ul>
<p class="training-video-resources rubric">Student Materials</p>
<ul class="training-video-resources simple">
<li><a class="reference internal" href="galera-mariadb-installing-examples.html"><span class="doc">Example Configuration</span></a></li>
<li><a class="reference external" href="https://galeracluster.com/library-media/databases/company.tgz">Company Database</a></li>
</ul>
</div>
<div class="banner container">
<p class="section-heading rubric">Exercises</p>
</div>
<p>Before starting an exercise, read it fully and carefully. The headings for each set of exercises corresponds to the section with the same name in the training video.  Make notes for yourself, after successfully performing each exercise, for when you have to do these tasks later for yourself.</p>
<p class="sub-heading rubric">Creating AWS Instances</p>
<p>Do these exercises after viewing the first three sections of the training video:  <em>Galera Cluster Overview</em>, <em>Encryption Key</em>, and <em>Creating AWS Instances</em>. Don’t install any software or configure the nodes, yet.</p>
<ol class="list-exercises arabic simple">
<li>Generate an encryption key for accessing nodes.  Then log into AWS and create three instances with a distribution of Linux you prefer.</li>
<li>Create a security group to use with your instances. Add rules to allow traffic among them, using their internal IP addresses. Open TCP ports 22, 3306, 4444, 4567, and 4568 for each node. Also open UDP port 4567 for each.</li>
</ol>
<p class="sub-heading rubric">Installing Software on Nodes</p>
<p>Do these exercises after viewing <em>Installing Software on Nodes</em> on the training video. Don’t configure the nodes until the next section.</p>
<ol class="list-exercises arabic simple" start="3">
<li>If you prefer to use MySQL, use a web browser to go to Codership’s web site (see links in margin) to get the URL’s for the latest wsrep-MySQL and the Galera Cluster packages.  Use a text editor to create a repository file on each node and include the URLs you copied.  See the margin for links to the Codership’s documentation page which shows how to construct a repository file.  If you prefer to use MariaDB, go to The MariaDB Foundation page to construct a repository file based on the Linux distribution and version you’re using. Get at least version 10.4 of MariaDB.</li>
<li>Install MySQL or MariaDB, and Galera on each node.  When finished, start <code class="docutils literal"><span class="pre">mysqld</span></code> on each node—don’t bootstrap Galera. For MySQL, grep the MySQL log for root’s temporary password.  For MariaDB, there is no password, initially. Run <code class="docutils literal"><span class="pre">mysql_secure_install</span></code> on each node and change the root password, as well as respond to the other questions it asks.  Then try logging into MySQL or MariaDB with the mysql client as root with the new password.  Exit and shutdown <code class="docutils literal"><span class="pre">mysqld</span></code>.</li>
</ol>
<p class="sub-heading rubric">Configuring Nodes &amp; Opening Ports</p>
<p>Do these exercises after viewing the two sections related to this combined title. MySQL or MariaB should be down on each node; don’t start <code class="docutils literal"><span class="pre">mysqld</span></code> again until the next section.</p>
<ol class="list-exercises arabic simple" start="5">
<li>Edit the database configuration file to include settings needed for Galera Cluster.  There’s a link at the top under Student Materials for an example configuration file. Don’t start <code class="docutils literal"><span class="pre">mysqld</span></code> yet. Configure each node before proceeding to the next exercise.</li>
<li>Configure either SELinux or Firewalld or both to open the following ports:  TCP 22, TCP 3306. TCP 4444, TCP &amp; UDP 4567, and TCP 4568. If you want to use only SELinux or only Firewalld, disable the one not used.</li>
</ol>
<p class="sub-heading rubric">Starting Galera</p>
<p>This is the core of the training video. You may encounter problems as you do these exercises. Don’t let it frustrate you, but don’t stop trying to complete them. This is important. Keep at it until you’re able to do them.</p>
<ol class="list-exercises arabic simple" start="7">
<li>Choose a node to be the seed node—anyone will be fine. Start MySQL and Galera on the one node by using the <code class="docutils literal"><span class="pre">mysqld_bootstrap</span></code> script.  If you’re using MariaDB, start it with Galera by using the <code class="docutils literal"><span class="pre">galera_new_cluster</span></code> script. If there are any errors, shutdown <code class="docutils literal"><span class="pre">mysqld</span></code> and read the full error messages, as well as look through the database log for clues. Resolve any problems and keep trying until you get it started. Then execute <code class="docutils literal"><span class="pre">SHOW</span> <span class="pre">STATUS</span></code> with the <code class="docutils literal"><span class="pre">LIKE</span></code> operator to see if Galera is running.</li>
<li>Once you have the first node running MySQL or MariaDB, and Galera, start mysqld on one of the other nodes—don’t use the <code class="docutils literal"><span class="pre">mysqld_bootstrap</span></code> and <code class="docutils literal"><span class="pre">galera_new_cluster</span></code> scripts.  If there are any errors, shutdown mysqld and resolve them until you get it started. Execute the <code class="docutils literal"><span class="pre">SHOW</span> <span class="pre">STATUS</span></code> statement with the <code class="docutils literal"><span class="pre">LIKE</span></code> operator to see the <code class="docutils literal"><span class="pre">wsrep_cluster_size</span></code>. It should have a value of 2.</li>
<li>Download the dump file containing the <code class="docutils literal"><span class="pre">company</span></code> database (see link at the top under Student Materials) onto the first node.  There’s one for MySQL and another for MariaDB: use the one that matches your database system. Both were created with <code class="docutils literal"><span class="pre">mysqldump</span></code>, so use the <code class="docutils literal"><span class="pre">mysql</span></code> client to load the data.  When it’s finished, check the second node to see if it replicated the data.</li>
<li>Start <code class="docutils literal"><span class="pre">mysqld</span></code> on the third node.  After it has successfully joined the cluster, look to see if it has replicated the <code class="docutils literal"><span class="pre">company</span></code> database. Enter the <code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">DATABASE</span></code> statement to create a database without tables. Check that the other nodes replicated it.</li>
<li>Shut down all of the nodes and restart them, using <code class="docutils literal"><span class="pre">mysqld_bootstrap</span></code> to start only the first node, which should be the last one that was shutdown. If you have problems, check the <code class="docutils literal"><span class="pre">grastate.dat</span></code> file in the data directory to ensure the <code class="docutils literal"><span class="pre">safe_to_bootstrap</span></code> parameter is set to 1.</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you struggled at any point in doing these exercises, especially in getting the Galera nodes started, you might want to do them again.  Start with fresh installations of the servers, without MySQL or MariaDB or Galera Cluster.  If you use the same servers, before doing the exercises again, uninstall the database software and Galera, and delete the data directory.  Do the exercises multiple times until you’re able to install, configure, and start a Galera cluster without any problems.</p>
</div>
<div class="bottom-links container">
<p>Related Documents</p>
<ul class="simple">
<li><a class="reference internal" href="../../documentation/firewall-settings.html"><span class="doc">Firewall Settings</span></a></li>
<li><a class="reference internal" href="../../documentation/firewalld.html"><span class="doc">firewalld</span></a></li>
<li><a class="reference internal" href="../../documentation/install.html"><span class="doc">Installing Galera</span></a></li>
<li><a class="reference internal" href="../../documentation/node-provisioning.html"><span class="doc">Node Provisioning</span></a></li>
<li><a class="reference internal" href="../../documentation/selinux.html"><span class="doc">SELinux</span></a></li>
<li><a class="reference internal" href="../../documentation/state-transfer.html"><span class="doc">State Transfer</span></a></li>
<li><a class="reference internal" href="../../documentation/mysql-wsrep-options.html"><span class="doc">wsrep Options</span></a></li>
</ul>
<p>Other Resources</p>
<ul class="simple">
<li><a class="reference external" href="https://downloads.mariadb.org/mariadb/repositories/">MariaDB Repo. Generator</a></li>
<li><a class="reference external" href="http://releases.galeracluster.com/">Galera Repository</a></li>
<li><a class="reference external" href="../../documentation/install-mysql.html#mysql-yum-repo">Configure Repo File</a></li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Training Video Exercises</a><ul>
<li><a class="reference internal" href="#installing-a-galera-cluster-on-aws">Installing a Galera Cluster on AWS</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Codership Training</a><ul>
  <li><a href="index.html">Codership Training Videos</a><ul>
  <li><a href="galera-aws-installing.html">Installing a Galera Cluster on AWS</a><ul>
      <li>Previous: <a href="galera-aws-installing.html" title="previous chapter">Installing a Galera Cluster on AWS</a></li>
      <li>Next: <a href="galera-standard-replication.html" title="next chapter">Standard Replication &amp; Galera Cluster</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
	<div class="navbar">
	<nav id="site-navigation" class="navigation main-navigation" role="navigation">
	<div class="nav-bar-container">

	<div id="menu-nav-bar" class="nav-menu">
		<ul class="nav-link">
			<li> </li>

		</ul>

	</div>
	</nav>

	<footer id="colophon" class="site-footer" role="contentinfo">
	<div class="top">	<div class="powered-by"><p>Powered by Galera:</p>
	<p><a href="https://mariadb.com/kb/en/galera/"><img class="alignleft size-full wp-image-237" alt="MariaDB" src="https://galeracluster.com/wp-content/uploads/2013/10/logo-mariadb.png" width="166" height="49" /></a></p>
		</div></div>
	<div class="footer-menu">
	<div class="menu-main-menu-container">
	<ul id="menu-main-menu-1" class="nav-menu">
	<li class="link-home menu-item menu-item-type-post_type menu-item-object-page menu-item-359"><a href="https://galeracluster.com/">Home</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-35"><a href="https://galeracluster.com/products/">Products</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-34"><a href="https://galeracluster.com/downloads/">Downloads</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-12 current_page_item current-menu-ancestor current-menu-parent current_page_parent current_page_ancestor menu-item-has-children menu-item-33"><a href="https://galeracluster.com/support/">Support</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-32"><a href="https://galeracluster.com/community/">Community</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31"><a href="https://galeracluster.com/company/">Company</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-297"><a href="https://galeracluster.com/category/blog/">Blog</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38"><a href="https://galeracluster.com/contact-us/">Contact us</a></li>
	</ul></div>			</div><!-- .footer-menu -->


	<div class="footer-bar">
	<p class="copyright">2014 Codership Ltd.</p>
	</div>
	<div class="footnote">
	<h2>Your data is invaluable. We're here to secure it. All of it.</h2>
	</div>
	</footer><!-- #colophon -->




  </body>
</html>