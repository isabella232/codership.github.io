<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta content="Training Video Exercises |---| Monitoring a Galera Cluster" name="title" />
<meta content="en-US" name="language" />
<meta content="Codership Oy, 2014 - 2019. All Rights Reserved." name="copyright" />

    <title>Training Video Exercises &#8212; Galera Cluster Documentation</title>
    
    <link rel="stylesheet" href="../../_static/reset-style.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Making Back-Ups with Galera Cluster" href="galera-backup.html" />
    <link rel="prev" title="Monitoring a Galera Cluster" href="galera-monitoring.html" />


<script type="text/javascript" src="https://www.google.com/jsapi"></script>

<link rel="stylesheet" href="/library/_static/basic-style.css">
<link rel="stylesheet" href="/library/_static/header.css">
<link rel="stylesheet" href="/library/_static/footer.css">
<link rel="stylesheet" href="/library/_static/codership.css">

<link rel="alternate" type="application/rss+xml" title="Galera Cluster for MySQL &raquo; Feed" href="https://galeracluster.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Galera Cluster for MySQL &raquo; Comments Feed" href="https://galeracluster.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Galera Cluster for MySQL &raquo; Support Comments Feed" href="https://galeracluster.com/support/feed/" />

<script type='text/javascript' src='https://galeracluster.com/wp-includes/js/comment-reply.min.js?ver=3.8.3'></script>

<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://galeracluster.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://galeracluster.com/wp-includes/wlwmanifest.xml" />
<link rel='prev' title='Downloads' href='https://galeracluster.com/downloads/' />
<link rel='next' title='Community' href='https://galeracluster.com/community/' />
<meta name="generator" content="WordPress 3.8.3" />

<link rel='shortlink' href='https://galeracluster.com/?p=12' />

<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<style type="text/css" id="twentythirteen-header-css">
			.site-title,
			.site-description {
				position: absolute;
				clip: rect(1px 1px 1px 1px); /* IE7 */
				clip: rect(1px, 1px, 1px, 1px);
			}
				.site-header .home-link {
				min-height: 0;
			}
</style>

<script type="text/javascript">

		  var _gaq = _gaq || [];
		  _gaq.push(['_setAccount', 'UA-35163478-6']);
		  _gaq.push(['_trackPageview']);

		  (function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'https://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		  })();

</script>

  </head>
  <body role="document">
	<div id="fb-root"></div>
	<script>(function(d, s, id) {
		  var js, fjs = d.getElementsByTagName(s)[0];
		  if (d.getElementById(id)) return;
		  js = d.createElement(s); js.id = id;
		  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
		  fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));
	</script>

	<div id="page" class="hfeed site">

	<header id="masthead" class="site-header" role="banner">

	<div class="top">
	<a class="home-link" href="https://galeracluster.com/" title="Galera Cluster for MySQL" rel="home">
	<h1 class="site-title">Galera Cluster for MySQL</h1>
	<h2 class="site-description">The world&#039;s most advanced open source database cluster</h2>
	</a>
	</div>


	<div id="navbar" class="navbar">
	<nav id="site-navigation" class="navigation main-navigation" role="navigation">
	<div class="menu-main-menu-container">

	<ul id="menu-main-menu" class="nav-menu">
	<li id="menu-item-359" class="link-home menu-item menu-item-type-post_type menu-item-object-page menu-item-359"><a href="https://galeracluster.com/">Home</a></li>
	<li id="menu-item-35" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-35"><a href="https://galeracluster.com/products/">Products</a></li>
	<li id="menu-item-34" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-34"><a href="https://galeracluster.com/downloads/">Downloads</a></li>
	<li id="menu-item-33" class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-12 current_page_item current-menu-ancestor current-menu-parent current_page_parent current_page_ancestor menu-item-has-children menu-item-33"><a href="https://galeracluster.com/support/">Support</a></li>
	<li id="menu-item-32" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-32"><a href="https://galeracluster.com/community/">Community</a></li>
	<li id="menu-item-31" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31"><a href="https://galeracluster.com/company/">Company</a></li>
	<li id="menu-item-297" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-297"><a href="https://galeracluster.com/category/blog/">Blog</a></li>
	<li id="menu-item-38" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38"><a href="https://galeracluster.com/contact-us/">Contact us</a></li>
	</ul>
	</div>


	</nav><!-- #site-navigation -->

	</div><!-- #navbar -->
	</header><!-- #masthead -->


  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="left-margin container">
<div class="left-margin-top container">
<a class="reference internal" href="../../index.html"><span class="doc">The Library</span></a></div>
<div class="left-margin-content container">
<ul>
<li><p class="first"><a class="reference internal" href="../../documentation/index.html"><span class="doc">Documentation</span></a></p>
</li>
<li><p class="first"><a class="reference internal" href="../../kb/index.html"><span class="doc">Knowledge Base</span></a></p>
<ul class="sub-links simple">
<li><a class="reference internal" href="../../kb/trouble/index.html"><span class="doc">Troubleshooting</span></a></li>
<li><a class="reference internal" href="../../kb/best/index.html"><span class="doc">Best Practices</span></a></li>
</ul>
<ul class="simple">
<li><a class="reference internal" href="../index.html"><span class="doc">Training</span></a></li>
</ul>
<ul class="sub-links simple">
<li><a class="reference internal" href="../tutorials/index.html"><span class="doc">Tutorial Articles</span></a></li>
</ul>
<ul class="sub-links here simple">
<li><a class="reference internal" href="index.html"><span class="doc">Training Videos</span></a></li>
</ul>
<p>Related Documents</p>
<ul class="simple">
<li><a class="reference internal" href="../../documentation/firewall-settings.html"><span class="doc">Firewall Settings</span></a></li>
<li><a class="reference internal" href="../../documentation/firewalld.html"><span class="doc">firewalld</span></a></li>
<li><a class="reference internal" href="../../documentation/install.html"><span class="doc">Installing Galera</span></a></li>
<li><a class="reference internal" href="../../documentation/node-provisioning.html"><span class="doc">Node Provisioning</span></a></li>
<li><a class="reference internal" href="../../documentation/selinux.html"><span class="doc">SELinux</span></a></li>
<li><a class="reference internal" href="../../documentation/state-transfer.html"><span class="doc">State Transfer</span></a></li>
<li><a class="reference internal" href="../../documentation/mysql-wsrep-options.html"><span class="doc">wsrep Options</span></a></li>
</ul>
<p>Related Articles</p>
<ul class="simple">
<li><a class="reference internal" href="../tutorials/galera-monitoring.html"><span class="doc">Galera Monitoring</span></a></li>
</ul>
<p>Other Resources</p>
<ul class="simple">
<li><a class="reference external" href="http://releases.galeracluster.com/">Galera Repository</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="library-article training-exercises section" id="training-video-exercises">
<span id="exercises-galera-monitoring"></span><h1>Training Video Exercises<a class="headerlink" href="#training-video-exercises" title="Permalink to this headline">¶</a></h1>
<div class="section" id="monitoring-a-galera-cluster">
<h2>Monitoring a Galera Cluster<a class="headerlink" href="#monitoring-a-galera-cluster" title="Permalink to this headline">¶</a></h2>
<div class="video-abstract list-col2-3 container">
<p>These exercises are part of the training video, <em>Monitoring a Galera Cluster</em>.  They correspond to what was taught, and should be done after viewing each section, unless otherwise noted.</p>
<p>Before starting these exercises, make sure you have all of the requirements and preparations in place.</p>
</div>
<div class="list-col1-3 container">
<p class="training-video-resources rubric">Requirements &amp; Preparation</p>
<ul class="training-video-resources simple">
<li>Test Servers:  3</li>
<li>Operating System:  Linux</li>
<li>Open Ports:  TCP 22, TCP 3306. TCP 4444, TCP &amp; UDP 4567, TCP 4568</li>
<li>Software:  MySQL or MariaDB, Galera Cluster</li>
</ul>
<p class="training-video-resources rubric">Student Materials</p>
<ul class="training-video-resources simple">
<li><a class="reference internal" href="galera-mariadb-installing-examples.html"><span class="doc">Example Configuration</span></a></li>
</ul>
</div>
<div class="banner container">
<p class="section-heading rubric">Exercises</p>
</div>
<p>Before starting an exercise, read it fully and carefully. The headings for each set of exercises corresponds generally to the section with the same name in training video.</p>
<p class="sub-heading rubric">Galera Status Variables</p>
<p>Do these exercises after viewing the first two sections of the training video:  <em>Galera Monitoring Overview</em>, and <em>Galera Status Variables</em>.</p>
<ol class="list-exercises arabic simple">
<li>With MySQL or MariaDB, and Galera running on all three nodes, execute the <code class="docutils literal"><span class="pre">SHOW</span> <span class="pre">STATUS</span></code> statement with the <code class="docutils literal"><span class="pre">LIKE</span></code> operator to obtain a list of all variables with the prefix wsrep. Scroll through the variables to familiarize yourself with them.  Make note of ones you think would be useful to monitor.</li>
<li>Execute <code class="docutils literal"><span class="pre">SHOW</span> <span class="pre">STATUS</span></code> again, but retrieve the variables which will tell you the status of the cluster and another for the state of the node on which it&#8217;s executed. Do it again, but this time get only the cluster size.</li>
<li>Check the replication health by checking the flow control, the <code class="docutils literal"><span class="pre">wsrep_local_recv_%</span></code> and the <code class="docutils literal"><span class="pre">wsrep_local_send_%</span></code> status variables.</li>
</ol>
<p class="sub-heading rubric">Server Logs</p>
<p>Do these exercises after viewing the section of the training video entitled, <em>Server Logs</em>. MySQL or MariaDB should running on all nodes.</p>
<ol class="list-exercises arabic simple" start="4">
<li>On one of the nodes, execute the <code class="docutils literal"><span class="pre">SHOW</span> <span class="pre">VARIABLES</span></code> statement to determine the path and name of the error log.  Use a tool like <code class="docutils literal"><span class="pre">more</span></code> or <code class="docutils literal"><span class="pre">less</span></code> to view the contents of the log.  Search for error messages and warnings.  Familiarize yourself with how Galera records information in the log.</li>
<li>In the database configuration file for one of the nodes, set Galera to log information about conflicts. Also, enable debugging.  In a separate terminal window, use <code class="docutils literal"><span class="pre">tail</span></code> with the <code class="docutils literal"><span class="pre">-f</span></code> option to monitor entries in the error log.  Then restart the database software and Galera.  Enter some transactions and observe the new entries in the error log.</li>
</ol>
<p class="sub-heading rubric">Notification Command &amp; Customized Scripts</p>
<p>These exercises will take some time to do, but they&#8217;ll be a good exercise for learning how to develop a notification command of your own.</p>
<ol class="list-exercises arabic simple" start="6">
<li>Create a notification command script using <code class="docutils literal"><span class="pre">bash</span></code> or another shell scripting language. You may use the example from the video as a starting point. There&#8217;s a link to it at the top under Student Materials.  You&#8217;ll have to modify it for your system. Set it to record information in a simple text file. Try executing it manually by giving it the parameters it expects from the command-line.  Check its log file to see the results.</li>
<li>Once you have the notification script in good shape, add the <code class="docutils literal"><span class="pre">wsrep_notify_cmd</span></code> paramter to the database configuration file for one of the nodes and provide the path and name of the script. Do this while all three nodes are running. Restart the node that is hosting the script.</li>
<li>With all three nodes running and the notification script in place on one node, take down one of the other nodes.  Check the notification command&#8217;s log to see what it recorded.  Start the node that&#8217;s down and check the log again.  Notice how much it recorded and didn&#8217;t record.  Try to improve the information logged.</li>
<li>Modify your script to alert you of a node down.  Use your imagination and skills to use some method that would be fairly dependable.  When you have it done, test it by shutting down a node.</li>
</ol>
<p class="sub-heading rubric">Third-Party Software</p>
<p>This exercise is meant to acquaint you with the third-party software for monitoring Galera, and to get you thinking about using them in production.</p>
<ol class="list-exercises arabic simple" start="10">
<li>Look into one of the third-party software available for monitoring a Galera Cluster.  Familiarize yourself with what&#8217;s available—for free and at a price.  Try to find a free one—or one that at least allows for free trials—that might work for your situation.  If you&#8217;re not sure, try the Nagios scripts (see link in margin). Whatever you choose,  download it and try it on your test servers.</li>
</ol>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Training Video Exercises</a><ul>
<li><a class="reference internal" href="#monitoring-a-galera-cluster">Monitoring a Galera Cluster</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Codership Training</a><ul>
  <li><a href="index.html">Codership Training Videos</a><ul>
  <li><a href="galera-monitoring.html">Monitoring a Galera Cluster</a><ul>
      <li>Previous: <a href="galera-monitoring.html" title="previous chapter">Monitoring a Galera Cluster</a></li>
      <li>Next: <a href="galera-backup.html" title="next chapter">Making Back-Ups with Galera Cluster</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
	<div class="navbar">
	<nav id="site-navigation" class="navigation main-navigation" role="navigation">
	<div class="nav-bar-container">

	<div id="menu-nav-bar" class="nav-menu">
		<ul class="nav-link">
			<li> </li>

		</ul>

	</div>
	</nav>

	<footer id="colophon" class="site-footer" role="contentinfo">
	<div class="top">	<div class="powered-by"><p>Powered by Galera:</p>
	<p><a href="https://mariadb.com/kb/en/galera/"><img class="alignleft size-full wp-image-237" alt="MariaDB" src="https://galeracluster.com/wp-content/uploads/2013/10/logo-mariadb.png" width="166" height="49" /></a></p>
		</div></div>
	<div class="footer-menu">
	<div class="menu-main-menu-container">
	<ul id="menu-main-menu-1" class="nav-menu">
	<li class="link-home menu-item menu-item-type-post_type menu-item-object-page menu-item-359"><a href="https://galeracluster.com/">Home</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-35"><a href="https://galeracluster.com/products/">Products</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-34"><a href="https://galeracluster.com/downloads/">Downloads</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-12 current_page_item current-menu-ancestor current-menu-parent current_page_parent current_page_ancestor menu-item-has-children menu-item-33"><a href="https://galeracluster.com/support/">Support</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-32"><a href="https://galeracluster.com/community/">Community</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31"><a href="https://galeracluster.com/company/">Company</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-297"><a href="https://galeracluster.com/category/blog/">Blog</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38"><a href="https://galeracluster.com/contact-us/">Contact us</a></li>
	</ul></div>			</div><!-- .footer-menu -->


	<div class="footer-bar">
	<p class="copyright">2014 Codership Ltd.</p>
	</div>
	<div class="footnote">
	<h2>Your data is invaluable. We're here to secure it. All of it.</h2>
	</div>
	</footer><!-- #colophon -->




  </body>
</html>